From 9a6564bc1a2f2eeaf9faffd4d3b0a5a562855123 Mon Sep 17 00:00:00 2001
From: rpm-build <rpm-build>
Date: Tue, 9 Oct 2018 15:42:09 +0200
Subject: [PATCH] Fix to re-enable CUPS filters creation (needed for
 ghostscript-cups)

---
 Makefile.in  | 2 ++
 configure.ac | 9 +++++++++
 2 files changed, 11 insertions(+)

diff --git a/Makefile.in b/Makefile.in
index d6f114a..bdf0ae7 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -351,6 +351,8 @@ CUPSSERVERROOT=@CUPSSERVERROOT@
 CUPSDATA=@CUPSDATA@
 CUPSPDFTORASTER=@CUPSPDFTORASTER@
 
+CUPSINSTTARGET=@CUPSINSTALL@
+
 SHARE_LCUPS=@SHARELCUPS@
 LCUPS_NAME=cups
 LCUPSSRCDIR=@CUPS_DIR@
diff --git a/configure.ac b/configure.ac
index 8ecaccc..d063c1f 100644
--- a/configure.ac
+++ b/configure.ac
@@ -1400,6 +1400,10 @@ AC_ARG_WITH([local-cups], AC_HELP_STRING([--with-local-cups],
                                              [Force using the GS supplied cups code - only useful for debugging]),
             [with_local_cups=yes], [with_local_cups=no])
 
+AC_ARG_WITH([install-cups], AC_HELP_STRING([--with-install-cups],
+                                             [Install the cups conversion tools]),
+            [CUPSINSTALL=install-cups], [CUPSINSTALL=])
+
 AC_ARG_WITH([cups-serverbin],  AC_HELP_STRING([--with-cups-serverbin],
     [override the "cups-config --serverbin" path]), CUPS_SERVERBIN="$withval", CUPS_SERVERBIN="")
 
@@ -3029,6 +3033,11 @@ if test x"$THEMAKEFILE" != x"$MAKEFILE" && test x"$CCAUX" = x"$CC"; then
   CONFIG_FILES_LIST="$CONFIG_FILES_LIST"
 fi
 
+if ( test -d cups ); then
+AC_OUTPUT(cups/gstopxl)
+chmod +x cups/gstopxl
+fi
+
 if test "x$AFS" = "x1"; then
    AC_MSG_WARN([Using "native" font scaler which is now deprecated (rather than freetype),])
    AC_MSG_WARN([Support for this will be removed in a future release])
-- 
2.14.4

