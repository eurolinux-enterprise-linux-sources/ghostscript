diff -up ghostscript-8.70/base/gsgdata.c.CVE-2010-4054 ghostscript-8.70/base/gsgdata.c
--- ghostscript-8.70/base/gsgdata.c.CVE-2010-4054	2007-09-25 14:31:24.000000000 +0100
+++ ghostscript-8.70/base/gsgdata.c	2011-12-21 13:38:02.945310493 +0000
@@ -50,8 +50,11 @@ gs_glyph_data_substring(gs_glyph_data_t
 void
 gs_glyph_data_free(gs_glyph_data_t *pgd, client_name_t cname)
 {
-    pgd->procs->free(pgd, cname);
-    gs_glyph_data_from_null(pgd);
+    if (pgd != 0) {
+	if (pgd->procs != 0)
+	    pgd->procs->free(pgd, cname);
+	gs_glyph_data_from_null(pgd);
+    }
 }
 
 /* ------ Implementor support ------ */
diff -up ghostscript-8.70/base/gstype1.c.CVE-2010-4054 ghostscript-8.70/base/gstype1.c
--- ghostscript-8.70/base/gstype1.c.CVE-2010-4054	2009-04-16 17:00:34.000000000 +0100
+++ ghostscript-8.70/base/gstype1.c	2011-12-21 13:37:34.779850704 +0000
@@ -161,6 +161,8 @@ gs_type1_interpret(gs_type1_state * pcis
 	goto cont;
     ipsp->cs_data = *pgd;
     cip = pgd->bits.data;
+    if (cip == 0)
+	return (gs_note_error(gs_error_invalidfont));
   call:state = crypt_charstring_seed;
     if (encrypted) {
 	int skip = pdata->lenIV;
@@ -170,7 +172,9 @@ gs_type1_interpret(gs_type1_state * pcis
 	    decrypt_skip_next(*cip, state);
     }
     goto top;
-  cont:cip = ipsp->ip;
+  cont:if (ipsp < pcis->ipstack || ipsp->ip == 0)
+	return (gs_note_error(gs_error_invalidfont));
+    cip = ipsp->ip;
     state = ipsp->dstate;
   top:for (;;) {
 	uint c0 = *cip++;
diff -up ghostscript-8.70/base/gstype2.c.CVE-2010-4054 ghostscript-8.70/base/gstype2.c
--- ghostscript-8.70/base/gstype2.c.CVE-2010-4054	2007-09-25 14:31:24.000000000 +0100
+++ ghostscript-8.70/base/gstype2.c	2011-12-21 13:37:34.780850684 +0000
@@ -173,6 +173,8 @@ gs_type2_interpret(gs_type1_state * pcis
 	goto cont;
     ipsp->cs_data = *pgd;
     cip = pgd->bits.data;
+    if (cip == 0)
+	return (gs_note_error(gs_error_invalidfont));
   call:state = crypt_charstring_seed;
     if (encrypted) {
 	int skip = pdata->lenIV;
@@ -182,7 +184,9 @@ gs_type2_interpret(gs_type1_state * pcis
 	    decrypt_skip_next(*cip, state);
     }
     goto top;
-  cont:cip = ipsp->ip;
+  cont:if (ipsp < pcis->ipstack || ipsp->ip == 0)
+	return (gs_note_error(gs_error_invalidfont));
+    cip = ipsp->ip;
     state = ipsp->dstate;
   top:for (;;) {
 	uint c0 = *cip++;
diff -up ghostscript-8.70/base/gxtype1.c.CVE-2010-4054 ghostscript-8.70/base/gxtype1.c
--- ghostscript-8.70/base/gxtype1.c.CVE-2010-4054	2009-04-16 17:00:34.000000000 +0100
+++ ghostscript-8.70/base/gxtype1.c	2011-12-21 13:37:34.782850644 +0000
@@ -423,6 +423,8 @@ gs_type1_piece_codes(/*const*/ gs_font_t
 	case c_return:
 	    gs_glyph_data_free(&ipsp->cs_data, "gs_type1_piece_codes");
 	    --ipsp;
+	    if (ipsp < ipstack)
+		return (gs_note_error(gs_error_invalidfont));
 	    cip = ipsp->ip, state = ipsp->dstate;
 	    goto top;
 	case cx_hstem:
